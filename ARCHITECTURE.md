# PKI System Architecture & Workflow

## System Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PKI SYSTEM OVERVIEW                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Client A   â”‚         â”‚      CA      â”‚         â”‚   Client B   â”‚â”‚
â”‚  â”‚   (Alice)    â”‚         â”‚   Authority  â”‚         â”‚    (Bob)     â”‚â”‚
â”‚  â”‚              â”‚         â”‚              â”‚         â”‚              â”‚â”‚
â”‚  â”‚ â€¢ RSA Keys   â”‚         â”‚ â€¢ RSA Keys   â”‚         â”‚ â€¢ RSA Keys   â”‚â”‚
â”‚  â”‚ â€¢ Certificateâ”‚         â”‚ â€¢ Cert Store â”‚         â”‚ â€¢ Certificateâ”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                        â”‚                        â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                  â”‚                                 â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                         â”‚   DES Server    â”‚                        â”‚
â”‚                         â”‚                 â”‚                        â”‚
â”‚                         â”‚ â€¢ Message Store â”‚                        â”‚
â”‚                         â”‚ â€¢ PKI Validator â”‚                        â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Complete Message Flow

### Phase 1: Registration & Certificate Issuance

```
Alice                           CA Server                         Bob
  â”‚                                â”‚                               â”‚
  â”‚ 1. Generate RSA Key Pair       â”‚                               â”‚
  â”‚    (Public + Private)          â”‚                               â”‚
  â”‚                                â”‚                               â”‚
  â”‚ 2. Send Registration Request   â”‚                               â”‚
  â”‚    {client_id, public_key}     â”‚                               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                               â”‚
  â”‚                                â”‚                               â”‚
  â”‚                                â”‚ 3. Create Certificate:        â”‚
  â”‚                                â”‚    - Bind public key to ID    â”‚
  â”‚                                â”‚    - Set expiration date      â”‚
  â”‚                                â”‚    - Sign with CA private key â”‚
  â”‚                                â”‚                               â”‚
  â”‚ 4. Receive Certificate         â”‚                               â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
  â”‚                                â”‚                               â”‚
  â”‚                                â”‚ 5. Bob Registers              â”‚
  â”‚                                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                â”‚                               â”‚
  â”‚                                â”‚ 6. Bob Gets Certificate       â”‚
  â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                                â”‚                               â”‚
```

### Phase 2: Secure Message Transmission

```
Alice                     CA Server              DES Server              Bob
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 1. Request Bob's Cert    â”‚                       â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 2. Receive Bob's Cert    â”‚                       â”‚                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 3. Verify Signature      â”‚                       â”‚                   â”‚
  â”‚    with CA Public Key    â”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 4. Generate Random       â”‚                       â”‚                   â”‚
  â”‚    DES Session Key       â”‚                       â”‚                   â”‚
  â”‚    (e.g., "A1B2C3...")   â”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 5. Encrypt Message       â”‚                       â”‚                   â”‚
  â”‚    with DES Key          â”‚                       â”‚                   â”‚
  â”‚    M' = DES(M, Key)      â”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 6. Encrypt DES Key       â”‚                       â”‚                   â”‚
  â”‚    with Bob's RSA Pub    â”‚                       â”‚                   â”‚
  â”‚    K' = RSA(Key, Bob_Pub)â”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 7. Send {M', K', Certs}  â”‚                       â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚                          â”‚                       â”‚ 8. Store Message  â”‚
  â”‚                          â”‚                       â”‚    with msg_id    â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 9. Receive message_id    â”‚                       â”‚                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
  â”‚                          â”‚                       â”‚                   â”‚
  â”‚ 10. Share msg_id with Bob                        â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚                       â”‚                   â”‚
```

### Phase 3: Secure Message Reception

```
Bob                       DES Server              CA Server
  â”‚                          â”‚                       â”‚
  â”‚ 1. Request Message       â”‚                       â”‚
  â”‚    {msg_id, private_key, â”‚                       â”‚
  â”‚     certificate}         â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                          â”‚                       â”‚
  â”‚                          â”‚ 2. Verify Bob's Cert  â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                          â”‚                       â”‚
  â”‚                          â”‚ 3. Confirm Bob is     â”‚
  â”‚                          â”‚    intended receiver  â”‚
  â”‚                          â”‚                       â”‚
  â”‚                          â”‚ 4. Return {M', K'}    â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
  â”‚                          â”‚                       â”‚
  â”‚ 5. Decrypt DES Key       â”‚                       â”‚
  â”‚    Key = RSA_Decrypt     â”‚                       â”‚
  â”‚          (K', Bob_Priv)  â”‚                       â”‚
  â”‚                          â”‚                       â”‚
  â”‚ 6. Decrypt Message       â”‚                       â”‚
  â”‚    M = DES_Decrypt       â”‚                       â”‚
  â”‚        (M', Key)         â”‚                       â”‚
  â”‚                          â”‚                       â”‚
  â”‚ 7. Read Plaintext! âœ…     â”‚                       â”‚
  â”‚                          â”‚                       â”‚
```

## Certificate Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Digital Certificate                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Certificate ID:  a1b2c3d4e5f6                             â”‚
â”‚  Subject (Owner): alice                                     â”‚
â”‚  Public Key:      -----BEGIN PUBLIC KEY-----                â”‚
â”‚                   MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMI...     â”‚
â”‚                   -----END PUBLIC KEY-----                  â”‚
â”‚  Issued At:       2024-11-16T10:30:00                      â”‚
â”‚  Expires At:      2025-11-16T10:30:00                      â”‚
â”‚  Issuer:          Trusted Certificate Authority             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         CA's Digital Signature                     â”‚   â”‚
â”‚  â”‚  (Proves this certificate was issued by CA)        â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  Signature = RSA_Sign(                             â”‚   â”‚
â”‚  â”‚    SHA256(certificate_data),                       â”‚   â”‚
â”‚  â”‚    CA_Private_Key                                  â”‚   â”‚
â”‚  â”‚  )                                                  â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  Anyone can verify with CA's public key            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Encryption Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Message: "Hello Bob"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Layer 1: DES Encryption
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Encrypted Message: "8A3F9B2E..."                     â”‚
â”‚         (Encrypted with random DES session key)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Layer 2: RSA Encryption of Key
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Encrypted DES Key: "JK3m8s2N..."                            â”‚
â”‚  (Encrypted with Bob's RSA public key from certificate)      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Only Bob's private key can decrypt this!      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Decryption Order (Bob):
1. Use private key â†’ Decrypt DES key
2. Use DES key â†’ Decrypt message
3. Read plaintext!
```

## Security Properties

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Security Guarantees                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ… AUTHENTICATION                                          â”‚
â”‚     â€¢ Certificates prove identity                           â”‚
â”‚     â€¢ CA signature prevents forgery                         â”‚
â”‚     â€¢ Public key bound to owner                             â”‚
â”‚                                                             â”‚
â”‚  âœ… CONFIDENTIALITY                                         â”‚
â”‚     â€¢ Message encrypted with DES                            â”‚
â”‚     â€¢ DES key encrypted with RSA                            â”‚
â”‚     â€¢ Only receiver can decrypt                             â”‚
â”‚                                                             â”‚
â”‚  âœ… INTEGRITY                                               â”‚
â”‚     â€¢ Digital signatures detect tampering                   â”‚
â”‚     â€¢ Certificate verification ensures authenticity         â”‚
â”‚                                                             â”‚
â”‚  âœ… NON-REPUDIATION                                         â”‚
â”‚     â€¢ Sender cannot deny sending                            â”‚
â”‚     â€¢ Certificate proves sender identity                    â”‚
â”‚                                                             â”‚
â”‚  âœ… PERFECT FORWARD SECRECY                                 â”‚
â”‚     â€¢ Unique session key per message                        â”‚
â”‚     â€¢ Key compromise doesn't affect other messages          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Attack Prevention

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               What Attacks Does This Prevent?               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âŒ Eavesdropping                                           â”‚
â”‚     â†’ Message is encrypted with DES                         â”‚
â”‚                                                             â”‚
â”‚  âŒ Key Interception                                        â”‚
â”‚     â†’ DES key encrypted with RSA                            â”‚
â”‚                                                             â”‚
â”‚  âŒ Man-in-the-Middle                                       â”‚
â”‚     â†’ CA verifies all certificates                          â”‚
â”‚     â†’ Attacker cannot forge certificates                    â”‚
â”‚                                                             â”‚
â”‚  âŒ Identity Spoofing                                       â”‚
â”‚     â†’ Certificates prove identity                           â”‚
â”‚     â†’ CA signature cannot be faked                          â”‚
â”‚                                                             â”‚
â”‚  âŒ Message Tampering                                       â”‚
â”‚     â†’ Signature verification detects changes                â”‚
â”‚                                                             â”‚
â”‚  âŒ Replay Attacks                                          â”‚
â”‚     â†’ Unique session key per message                        â”‚
â”‚     â†’ Message ID prevents replay                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Differences: With vs Without PKI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WITHOUT PKI (Vulnerable)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Alice: "What's Bob's public key?"                          â”‚
â”‚  ???: "Here's my key!" (Could be attacker!)                â”‚
â”‚  Alice: *encrypts with fake key*                            â”‚
â”‚  Attacker: *intercepts and decrypts*                        â”‚
â”‚                                                             â”‚
â”‚  âŒ No way to verify key ownership                          â”‚
â”‚  âŒ Vulnerable to man-in-the-middle                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WITH PKI (Secure)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Alice: "CA, give me Bob's certificate"                     â”‚
â”‚  CA: "Here's Bob's certificate [Signed by CA]"              â”‚
â”‚  Alice: *verifies CA signature*                             â”‚
â”‚  Alice: *extracts Bob's verified public key*                â”‚
â”‚  Alice: *encrypts with authentic key*                       â”‚
â”‚                                                             â”‚
â”‚  âœ… Certificate proves key ownership                        â”‚
â”‚  âœ… CA signature prevents forgery                           â”‚
â”‚  âœ… Attacker cannot fake certificates                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Real-World Analogy

```
Traditional Mail (Without PKI):
  ğŸ“§ Alice writes letter to Bob
  â“ Is this really Bob's address?
  â“ Can I trust this mailbox?
  âš ï¸  Anyone could intercept

Public Key Certificates (With PKI):
  ğŸ“§ Alice writes letter
  ğŸ›ï¸  Government (CA) verifies Bob's address
  âœ… Certificate proves it's really Bob
  ğŸ” Encrypted so only Bob can read
  âœ… Secure delivery guaranteed
```
